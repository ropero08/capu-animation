<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CAPU Animation</title>
<style>
body{margin:0;font-family:sans-serif;background:#f0f0f0;}
#landing{display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column;background-size:cover;background-position:center;}
.card{background:white;padding:20px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.1);width:300px;text-align:center;}
input{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:1px solid #ccc;}
button{padding:10px 16px;margin-top:10px;border:none;background:#5b3f5b;color:white;border-radius:6px;cursor:pointer;}
button:hover{opacity:0.9;}
#app{display:none;padding:20px;}
header{display:flex;justify-content:space-between;align-items:center;background:white;padding:10px;border-bottom:1px solid #ccc;border-radius:12px;margin-bottom:20px;}
.avatar{width:50px;height:50px;border-radius:50%;overflow:hidden;}
.avatar img{width:100%;height:100%;object-fit:cover;}
</style>
</head>
<body>

<div id="landing">
  <div class="card">
    <h2>CAPU Animation</h2>
    <input type="text" id="regName" placeholder="Nombre completo">
    <input type="email" id="regEmail" placeholder="Correo">
    <input type="file" id="regAvatar" accept="image/*">
    <button onclick="register()">Crear cuenta / Entrar</button>
    <hr>
    <input type="email" id="loginEmail" placeholder="Correo">
    <button onclick="login()">Entrar</button>
    <p style="font-size:12px;margin-top:10px;color:#555;">Puedes personalizar el fondo y tu avatar.</p>
  </div>
</div>

<div id="app">
  <header>
    <div id="userName"></div>
    <div class="avatar"><img id="userAvatar" src=""></div>
    <button onclick="logout()">Salir</button>
  </header>
  <h1>
    Bienvenido a Capu Animation, tu espacio de videos animados sobre los Santos Dominicos. 
    Aquí podrás explorar sus vidas, enseñanzas y milagros a través de animaciones divertidas y educativas. 
    ¡Aprende, diviértete y deja que la historia te inspire!
  </h1>
  <input type="file" id="bgFile" accept="image/*">
  <button onclick="setBackground()">Aplicar Fondo</button>
</div>

<script>
let users=JSON.parse(localStorage.getItem('capu_users')||'{}');

function register(){
  const name=document.getElementById('regName').value.trim();
  const email=document.getElementById('regEmail').value.trim().toLowerCase();
  const file=document.getElementById('regAvatar').files[0];
  if(!name||!email) return alert("Completa los campos");
  if(file){
    const reader=new FileReader();
    reader.onload=()=>{saveUser(name,email,reader.result);}
    reader.readAsDataURL(file);
  } else saveUser(name,email,null);
}

function saveUser(name,email,avatar){
  users[email]={name,email,avatar};
  localStorage.setItem('capu_users',JSON.stringify(users));
  localStorage.setItem('capu_current',email);
  openApp();
}

function login(){
  const email=document.getElementById('loginEmail').value.trim().toLowerCase();
  if(!users[email]) return alert("Usuario no existe");
  localStorage.setItem('capu_current',email);
  openApp();
}

function openApp(){
  const email=localStorage.getItem('capu_current');
  const user=users[email];
  document.getElementById('landing').style.display='none';
  document.getElementById('app').style.display='block';
  document.getElementById('userName').textContent=user.name;
  document.getElementById('userAvatar').src=user.avatar||'https://via.placeholder.com/100';
}

function logout(){
  localStorage.removeItem('capu_current');
  location.reload();
}

function setBackground(){
  const file=document.getElementById('bgFile').files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=()=>{document.getElementById('app').style.backgroundImage=`url(${reader.result})`; document.getElementById('app').style.backgroundSize='cover';}
    reader.readAsDataURL(file);
  }
}

if(localStorage.getItem('capu_current')) openApp();
</script>

</body>
</html>
